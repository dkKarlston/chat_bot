version: "3.1"

rules:
  # Существующие правила
  - rule: Загрузка данных пользователя
    steps:
      - intent: greet
      - action: action_load_user_memory
      - active_loop: null

  - rule: Приветствие существующего пользователя
    condition:
      - slot_was_set:
          - name
          - favorite_topic
    steps:
      - action: utter_welcome_back
      - action: utter_ask_next

  - rule: Обработка нового пользователя
    condition:
      - slot_was_set:
          - name: null
          - favorite_topic: null
    steps:
      - action: utter_greet
      - action: utter_ask_name

  # Новые правила
  - rule: Меню после приветствия
    steps:
      - intent: greet
      - action: utter_greet  # Показ меню с кнопками

  - rule: Обработка погоды
    steps:
      - intent: ask_weather
      - action: utter_weather

  - rule: Обработка новостей
    steps:
      - intent: ask_news
      - action: utter_news